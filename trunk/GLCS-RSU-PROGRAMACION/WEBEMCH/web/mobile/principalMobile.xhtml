<f:view xmlns="http://www.w3.org/1999/xhtml"       
        xmlns:f="http://java.sun.com/jsf/core"    
        xmlns:h="http://java.sun.com/jsf/html"   
        xmlns:ui="http://java.sun.com/jsf/facelets"    
        xmlns:p="http://primefaces.org/ui"      
        xmlns:pm="http://primefaces.org/mobile"   
        contentType="text/html" 
        renderKitId="PRIMEFACES_MOBILE"        
        xmlns:c="http://java.sun.com/jsp/jstl/core">   

    <pm:page title="EMCH Servicios Ecologicos">
        <f:facet name="preinit">
            <link type="text/css" rel="stylesheet" href="../themes/mobile.css" />
            <!-- AQUI DEBE IR EL TEMA DE JQUERY -->
        </f:facet>

        <f:facet name="postinit">                        
            <h:outputStylesheet library="primefaces-mobile" name="calendar/calendar.css"  />
            <h:outputScript library="primefaces-mobile" name="calendar/calendar.js" />            

            <script type="text/javascript">
                (function($) {
                    $.mobiscroll.i18n['pt_BR'] = $.extend($.mobiscroll.i18n['pt_BR'], {
                        dateFormat: 'dd/mm/yy',
                        dateOrder: 'ddMMyy',
                        dayNames: ['Domingo', 'Segunda-feira', 'Terça-feira', 'Quarta-feira', 'Quinta-feira', 'Sexta-feira', 'Sábado'],
                        dayNamesShort: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'],
                        dayText: 'Dia',
                        hourText: 'Hora',
                        minuteText: 'Minutos',
                        monthNames: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],
                        monthNamesShort: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],
                        monthText: 'Mês',
                        secText: 'Segundo',
                        timeFormat: 'HH:ii',
                        timeWheels: 'HHii',
                        yearText: 'Ano',
                        setText: 'Selecionar',
                        cancelText: 'Cancelar',
                        nowText: 'Agora'
                    });
                })(jQuery);
            </script>
        </f:facet>   

        <!--PÁGINA PRINCIPAL-->
        <pm:view id="consultas">
            <pm:header title="GLCS-RSU - Menú Principal">               
                <pm:navBar>
                    <p:button value="Inicio" icon="home" href="#consultas?reverse=true"/>
                    <p:button value="Usuario: #{usuarioBean.nomusuario}" icon="grid" onclick="PF('dlgBasic1').show()"/>                                                         
                    <p:commandButton value="Cerrar sesión" icon="minus" action="#{usuarioBean.logout()}"></p:commandButton>
                </pm:navBar>
            </pm:header>           
            <pm:content>

                <p:dataList type="inset">                    
                    <f:facet name="header">Control del Servicio</f:facet>
                    <h:outputLink value="#ConsultasDespacho">Despacho</h:outputLink>                    
                    <h:outputLink value="#ConsultasViaje">Control de Viaje</h:outputLink>                    
                    <h:outputLink value="#ConsultasAsistencia">Asistencia</h:outputLink>                                                            
                    <h:outputLink value="#ConsultasRuta">Rutas Asignadas</h:outputLink>                                                           
                </p:dataList>      

                <p:dataList type="inset">                    
                    <f:facet name="header">Operaciones</f:facet>
                    <h:outputLink value="#ConsultasLiquidaciones">Liquidaciones</h:outputLink>                    
                    <h:outputLink value="#ConsultasComprobantes">Comprobantes</h:outputLink>                    
                    <h:outputLink value="#ConsultasMapas">Mapas</h:outputLink>                                                       
                </p:dataList>      
            </pm:content>
            <!-- INICIO FOOTER-->
            <pm:footer>
                <pm:header title="Empresa (Cliente): #{usuarioBean.nomEmpresa}">                    
                </pm:header>    
                <h:panelGrid style="text-align: center">
                    <h:outputText style="font-size: 11px; text-align: center; margin-left: 2px; margin-right: 2px; margin-bottom: 0px" 
                                  value="© 2013 EMCH Servicios Ecológicos SAC. | Todos los derechos reservados. | comercial@emchsac.com - emchsac@emchsac.com" />
                </h:panelGrid>
            </pm:footer>
            <!-- FIN FOOTER-->
            <p:dialog header="Información Usuario" widgetVar="dlgBasic1" modal="true">
                <h:panelGrid columns="2">
                    Usuario: <h:outputText value="#{usuarioBean.nomusuario}" style="font-weight:bold;"/>
                    Empresa (Cliente): <h:outputText value="#{usuarioBean.nomEmpresa}" style="font-weight:bold;"/>
                    RUC (Cliente):<h:outputText value="#{usuarioBean.ruc}" style="font-weight:bold;"/>
                </h:panelGrid>
            </p:dialog>
        </pm:view> 

        <!--Consultar Despacho-->
        <pm:view id="ConsultasDespacho">
            <pm:header title="Consultar Despacho">
                <f:facet name="left"><p:button value="Regresar" icon="back" href="#consultas?reverse=true"/></f:facet>
                <pm:navBar>
                    <p:button value="Inicio" icon="home" href="#consultas?reverse=true"/>
                    <p:button value="Usuario: #{usuarioBean.nomusuario}" icon="grid" onclick="PF('dlgBasic2').show()"/>                                                         
                    <p:commandButton value="Cerrar sesión" icon="minus" action="#{usuarioBean.logout()}"></p:commandButton>                   
                </pm:navBar>
            </pm:header>             
            <pm:content>
                <h3>Visualizar Despachos</h3>

                <p:outputLabel value="Desde : " style="font-weight:bold;"/>
                <p:calendar value="#{despachoMobileBean.fecDesde}" effect="fade" pattern="dd/MM/yyyy HH:mm" mindate="01/01/12" maxdate="31/12/13">
                </p:calendar>

                <p:outputLabel  value="Hasta : " style="font-weight:bold;"/>
                <p:calendar value="#{despachoMobileBean.fecHasta}" effect="fade" pattern="dd/MM/yyyy HH:mm" mindate="01/01/12" maxdate="31/12/13">
                </p:calendar>                
                <pm:field>
                    <h:outputLabel value="Turno : " style="font-weight:bold;"/>
                    <h:selectOneMenu id="selectOneMenu"> 
                        <f:selectItem itemLabel="Mañana" itemValue="TN01" />
                        <f:selectItem itemLabel="Noche" itemValue="TN02" />
                    </h:selectOneMenu>
                </pm:field>
                <p:commandButton value="Buscar" icon="search" action="#{despachoMobileBean.irBuscarDespacho()}" update="ConsultasDespachoForm"></p:commandButton>
                <p:commandButton value="Limpiar Resultado" action="#{despachoMobileBean.irClearDespacho()}" update="ConsultasDespachoForm"></p:commandButton>
                <h:form id="ConsultasDespachoForm">
                    <c:forEach id="listDesp" var="despacho" items="#{despachoMobileBean.listaDespacho}" >                            
                        <p:panel header="DESPACHO : #{despacho.nroDespacho} - Fecha #{despacho.fechaEmi}" collapsed="true" >
                            <h:panelGrid columns="4">
                                <h:outputText value="Fecha : " style="font-weight:bold;"/>
                                <h:outputText value="#{despacho.fechaEmi}"/>
                                <h:outputText value="Turno: " style="font-weight:bold;"/>
                                <h:outputText value="#{despacho.TTurno.nombTurno}"/>
                                <h:outputText value="Zona: " style="font-weight:bold;"/>
                                <h:outputText value="#{despacho.zona}" />
                                <h:outputText value="(S/.) Enviado : " style="font-weight:bold;"/>
                                <h:outputText value="#{despacho.dineroEnviado}"/>
                                <h:outputText value="Total S/. en Uso :" style="font-weight:bold;"/>
                                <h:outputText value="#{despacho.totalDineroUso}"/>
                                <h:outputText value="Total S/. sin Uso: " style="font-weight:bold;"/>
                                <h:outputText value="#{despacho.totalDineroSinUso}"/>
                                <h:outputText value="Obs: " style="font-weight:bold;"/>
                                <h:outputText value="#{despacho.obs}"/>
                            </h:panelGrid>
                            <p:commandButton value="Ver Trabajadores Asignados" icon="arrow-r" actionListener="#{despachoMobileBean.buscarDespachoDet}" 
                                             action="pm:ConsultasDespachoDet" update=":ConsultasDespachoDetForm">
                                <f:setPropertyActionListener value="#{despacho}" target="#{despachoMobileBean.selectedDespacho}" />
                            </p:commandButton>

                        </p:panel> 
                    </c:forEach>
                </h:form>
            </pm:content>  
            <!-- INICIO FOOTER-->
            <pm:footer>
                <pm:header title="Empresa (Cliente): #{usuarioBean.nomEmpresa}">                    
                </pm:header>    
                <h:panelGrid style="text-align: center">
                    <h:outputText style="font-size: 11px; text-align: center; margin-left: 2px; margin-right: 2px; margin-bottom: 0px" 
                                  value="© 2013 EMCH Servicios Ecológicos SAC. | Todos los derechos reservados. | comercial@emchsac.com - emchsac@emchsac.com" />
                </h:panelGrid>
            </pm:footer>
            <!-- FIN FOOTER-->
            <p:dialog header="Información Usuario" widgetVar="dlgBasic2" modal="true">
                <h:panelGrid columns="2">
                    Usuario: <h:outputText value="#{usuarioBean.nomusuario}" style="font-weight:bold;"/>
                    Empresa (Cliente): <h:outputText value="#{usuarioBean.nomEmpresa}" style="font-weight:bold;"/>
                    RUC (Cliente):<h:outputText value="#{usuarioBean.ruc}" style="font-weight:bold;"/>
                </h:panelGrid>
            </p:dialog>
        </pm:view> 

        <!--Consultar DespachoDet (Trabajadores Asignados -->
        <pm:view id="ConsultasDespachoDet">
            <pm:header title="Consultar Despacho Detalle">
                <f:facet name="left"><p:button value="Regresar" icon="back" href="#ConsultasDespacho?reverse=true"/></f:facet>
                <pm:navBar>
                    <p:button value="Inicio" icon="home" href="#consultas?reverse=true"/>
                    <p:button value="Usuario: #{usuarioBean.nomusuario}" icon="grid" onclick="PF('dlgBasic3').show()"/>                                                         
                    <p:commandButton value="Cerrar sesión" icon="minus" action="#{usuarioBean.logout()}"></p:commandButton>                   
                </pm:navBar>
            </pm:header>   
            <pm:content>
                <h:form id="ConsultasDespachoDetForm">
                    <h:outputText value="DESPACHO : " style="font-weight:bold;"/>
                    <h:outputText value="#{despachoMobileBean.selectedDespacho.nroDespacho}"/>
                    <br></br>
                    <h:outputText value="Fecha : " style="font-weight:bold;"/>
                    <h:outputText value="#{despachoMobileBean.selectedDespacho.fechaEmi}"/>
                    <br></br>
                    <h:outputText value="Turno : " style="font-weight:bold;"/>
                    <h:outputText value="#{despachoMobileBean.selectedDespacho.TTurno.nombTurno}"/>                    
                    <c:forEach id="listDespDet" var="despachoDet" items="#{despachoMobileBean.listaDespachoDet}" >                            
                        <p:panel header="Trabajador #{despachoDet.TTrabajadorxcamion.TTrabajador.nombres} - Camión : #{despachoDet.TTrabajadorxcamion.TCamion.placa}" collapsed="true" >
                            <h:panelGrid columns="2">
                                 <h:outputText value="Nombre(s) : " style="font-weight:bold;"/>
                                 <h:outputText value="#{despachoDet.TTrabajadorxcamion.TTrabajador.nombres}"/>
                                 <h:outputText value="Apellidos(s) : " style="font-weight:bold;"/>
                                <h:outputText value="#{despachoDet.TTrabajadorxcamion.TTrabajador.apellidos}"/>
                                <h:outputText value="Camión Asignado : " style="font-weight:bold;"/>
                                <h:outputText value="#{despachoDet.TTrabajadorxcamion.TCamion.placa}"/>
                                <h:outputText value="Cant. Viajes : " style="font-weight:bold;"/>
                                <h:outputText value="#{despachoDet.cantViaje}"/>
                            </h:panelGrid>
                        </p:panel> 
                    </c:forEach>
                </h:form>
            </pm:content>
            <!-- INICIO FOOTER-->
            <pm:footer>
                <pm:header title="Empresa (Cliente): #{usuarioBean.nomEmpresa}">                    
                </pm:header>    
                <h:panelGrid style="text-align: center">
                    <h:outputText style="font-size: 11px; text-align: center; margin-left: 2px; margin-right: 2px; margin-bottom: 0px" 
                                  value="© 2013 EMCH Servicios Ecológicos SAC. | Todos los derechos reservados. | comercial@emchsac.com - emchsac@emchsac.com" />
                </h:panelGrid>
            </pm:footer>
            <!-- FIN FOOTER-->
            <p:dialog header="Información Usuario" widgetVar="dlgBasic3" modal="true">
                <h:panelGrid columns="2">
                    Usuario: <h:outputText value="#{usuarioBean.nomusuario}" style="font-weight:bold;"/>
                    Empresa (Cliente): <h:outputText value="#{usuarioBean.nomEmpresa}" style="font-weight:bold;"/>
                    RUC (Cliente):<h:outputText value="#{usuarioBean.ruc}" style="font-weight:bold;"/>
                </h:panelGrid>
            </p:dialog>
        </pm:view>
    </pm:page>
</f:view>
